#!/bin/sh
# sshd ai generated search term: "sshd init.d script start stop restart using pid store pid"


# Configuration variables
DAEMON=/usr/sbin/sshd
PIDFILE=/var/run/sshd.pid

# Function to start sshd
start() {
    echo -n "Starting sshd: "
    if [ -f "$PIDFILE" ] && [ -d /proc/$(cat "$PIDFILE") ]; then 
        # ps -p $(cat "$PIDFILE") > /dev/null; then
        echo "sshd already running."
        exit 1
    fi
    $DAEMON
    echo "OK"
}

# Function to stop sshd
stop() {
    echo -n "Stopping sshd: "
    if [ -f "$PIDFILE" ]; then
        kill $(cat "$PIDFILE")
        rm "$PIDFILE"
        echo "OK"
    else
        echo "sshd not running."
    fi
}

# Function to restart sshd
restart() {
    stop
    sleep 1 # Give time for the process to terminate
    start
}

case "$1" in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart)
        restart
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
        ;;
esac

exit 0
